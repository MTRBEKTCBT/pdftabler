test_that("conbini", {
  expect_output(str(conbini), "List of 2")
  expect_equal(class(conbini), "list")
})
test_that("pt_split_cell", {
  expect_equal(conbini |> pt_cell() |> class(), "list")
  expect_equal(conbini |> pt_cell() |> purrr::flatten_chr() |> length(), 3398)
})
test_that("pt_split_one", {
  expect_equal(conbini |>
                 pt_cell() |>
                 purrr::flatten_chr() |>
                 pt_split_one(29) |>
                 class(), c("tbl_df", "tbl", "data.frame"))
  expect_equal(conbini |>
                 pt_cell() |>
                 purrr::flatten_chr() |>
                 pt_split_one(29) |>
                 dim(), c(1, 15))
})
test_that("pt_split_multi", {
  expect_equal(conbini |>
                 pt_cell() |>
                 purrr::flatten_chr() |>
                 pt_split_multi(idx) |>
                 class(), c("tbl_df", "tbl", "data.frame"))
  expect_equal(conbini |>
                 pt_cell() |>
                 purrr::flatten_chr() |>
                 pt_split_multi(idx) |>
                 dim(), c(204, 15))
  expect_equal(conbini |>
                 pt_cell() |>
                 purrr::flatten_chr() |>
                 pt_split_multi(idx) |>
                 dplyr::pull(), c("-1.1%\n", "1.2%\n", "-0.9%\n", "-0.8%\n", "-2.1%\n", "-1.3%\n平成17年\n",
                          "0.1%\n", "-1.3%\n", "-0.6%\n", "-3.6%\n", "-2.8%\n", "-1.3%\n",
                          "-1.6%\n", "-2.4%\n", "-2.0%\n", "-0.1%\n", "-1.9%\n", "3.4%\n平成18年\n（2006）",
                          "-1.1%\n", "-0.9%\n", "-1.5%\n", "0.1%\n", "-0.2%\n", "-0.7%\n",
                          "-1.1%\n", "-1.2%\n", "-0.6%\n", "-0.4%\n", "-1.1%\n", "-4.2%\n平成19年\n（2007）",
                          "0.1%\n", "-0.6%\n", "-0.5%\n", "-1.6%\n", "-1.2%\n", "-0.8%\n",
                          "-0.8%\n", "-1.1%\n", "-0.3%\n", "-0.8%\n", "0.6%\n", "1.9%\n平成20年\n（2008）",
                          "-0.1%\n", "1.5%\n", "0.5%\n", "0.6%\n", "1.1%\n", "-1.0%\n",
                          "-0.5%\n", "-1.3%\n", "-0.7%\n", "-2.0%\n", "-1.5%\n", "-4.8%\n平成21年\n（2009）",
                          "-3.1%\n", "-3.8%\n", "-3.0%\n", "-2.8%\n", "-3.0%\n", "-2.9%\n",
                          "-3.8%\n", "-2.6%\n", "-3.4%\n", "-1.9%\n", "-2.3%\n", "-1.6%\n平成22年\n（2010）",
                          "-1.8%\n", "-1.9%\n", "10.6%\n", "-1.5%\n", "-0.8%\n", "1.9%\n",
                          "4.4%\n", "4.3%\n", "8.3%\n", "1.4%\n", "4.5%\n", "6.1%\n平成23年\n",
                          "6.9%\n", "7.9%\n", "-4.4%\n", "7.5%\n", "5.3%\n", "3.3%\n",
                          "1.7%\n", "2.3%\n", "-1.7%\n", "4.6%\n", "0.8%\n", "-0.3%\n平成24年\n",
                          "-0.6%\n", "-0.7%\n", "-0.7%\n", "-1.2%\n", "-0.3%\n", "-0.4%\n",
                          "1.0%\n", "-0.4%\n", "-0.03%\n", "-0.9%\n", "-0.4%\n", "0.6%\n平成25年\n",
                          "-0.8%\n", "-0.1%\n", "0.2%\n", "0.6%\n", "-0.6%\n", "-1.1%\n",
                          "-1.5%\n", "1.0%\n", "3.9%\n", "-1.8%\n", "-0.7%\n", "-1.0%\n平成26年",
                          "0.7%\n", "1.2%\n", "-0.3%\n", "0.1%\n", "0.2%\n", "1.0%\n",
                          "1.0%\n", "-1.5%\n", "-3.0%\n", "3.5%\n", "1.5%\n", "0.9%\n平成27年\n",
                          "1.1%\n", "0.4%\n", "2.6%\n", "0.4%\n", "1.3%\n", "0.3%\n", "0.3%\n",
                          "0.1%\n", "0.6%\n", "1.2%\n", "1.0%\n平成28年", "1.4%\n",
                          "0.7%\n", "1.2%\n", "0.2%\n", "1.6%\n", "1.2%\n", "1.4%\n", "1.2%\n",
                          "2.3%\n", "0.9%\n", "0.7%\n", "1.4%\n", "0.4%\n", "1.5%\n", "1.7%\n",
                          "2.1%\n", "3.2%\n", "0.9%\n", "1.4%\n2018/1/22時点", "2.9%\n",
                          "1.8%\n", "1.9%\n", "1.4%\n", "1.3%\n", "3.0%\n", "1.9%\n", "1.0%\n",
                          "6.3%\n", "-2.0%\n", "1.1%\n", "2.3%\n2019/1/22時点", "1.7%\n",
                          "1.9%\n", "1.7%\n", "3.0%\n", "2.8%\n", "2.2%\n", "2.3%\n", "3.3%\n",
                          "-1.6%\n", "4.1%\n", "2.5%\n", "0.7%\n2020/1/20時点", "1.2%\n",
                          "0.3%\n", "2.5%\n", "9.5%\n", "12.4%\n", "7.3%\n", "7.7%\n",
                          "4.2%\n", "9.0%\n", "6.9%\n", "8.6%\n", "7.4%\n2021/1/20時点",
                          "9.6%\n", "8.3%\n", "5.6%\n", "-1.1%\n", "-1.3%\n", "0.7%\n",
                          "3.1%\n", "5.0%\n", "4.6%\n", "0.5%\n", "0.3%\n", "3.2%\n2022/1/20時点"
                 ))
})
test_that("pt_split_year", {
  expect_equal(conbini |>
                 pt_cell() |>
                 purrr::flatten_chr() |>
                 pt_split_year() |>
                 class(), c("tbl_df", "tbl", "data.frame"))
  expect_equal(conbini |>
                 pt_cell() |>
                 purrr::flatten_chr() |>
                 pt_split_year() |>
                 dplyr::pull(), c("-1.1%\n", "1.2%\n", "-0.9%\n", "-0.8%\n", "-2.1%\n", "-1.3%\n平成17年\n",
                                            "0.1%\n", "-1.3%\n", "-0.6%\n", "-3.6%\n", "-2.8%\n", "-1.3%\n"
                 ))
})
